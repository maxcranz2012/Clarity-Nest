<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Yandex.Metrika counter -->
<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
    ym(98959916, "init", {
         clickmap:true,
         trackLinks:true,
         accurateTrackBounce:true,
         webvisor:true
    });
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/98959916" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 <!-- /Yandex.Metrika counter -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
    <title>Kakashka Clicker</title>
    <link rel="shortcut icon" href="k.png">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #131313;
            font-family: Arial, sans-serif;
            color: #fff;
            -webkit-touch-callout: none;
            -webkit-user-select: none;  
            user-select: none;           
            touch-action: manipulation;  
        }

        .intro-screen, .game-screen, .end-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            width: 100%;
            height: 100%;
        }

        .story-text {
            font-size: 24px;
            margin: 20px;
            opacity: 0;
            animation: fadeIn 2s forwards;
        }

        .hidden {
            display: none;
        }

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .click-count {
            font-size: 24px;
            font-weight: bold;
            color: orange;
        }

        .main-bat {
            width: 200px;
            margin: 20px;
            cursor: pointer;
            transition: transform 0.1s;
            touch-action: none; 
        }

        .main-bat:active {
            transform: translateY(-10px);
        }

        .buttons {
            display: flex;
            gap: 20px;
            align-items: center;
            top: 0%;
        }

        button {
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #0056b3;
        }
        .newgame:hover{
            background-color: #c0312c;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Animation for desktop */
        @keyframes explode {
            0% { opacity: 1; transform: scale(1) translate(0, 0); }
            100% { opacity: 0; transform: scale(2) translate(100px, -100px); }
        }

        .exploding {
            position: relative;
            animation: explode 1s forwards ease-out;
        }

     
        .click-text {
    position: absolute; 
    color: gold;
    font-size: 24px;
    font-weight: bold;
    pointer-events: none;
    animation: riseAndFade 1s forwards;
}


        @keyframes riseAndFade {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        /* Mobile-specific animation */
        @media (max-width: 768px) {
            .main-bat {
                transition: transform 0.2s ease;
                --tiltX: 0deg;
                --tiltY: 0deg;
                transform: rotateX(var(--tiltX)) rotateY(var(--tiltY));
            }

            .plus-one {
                position: absolute;
                font-family: Inter;
                text-shadow: 0px 0px 4px rgba(211, 155, 25, 0.25);
                font-size: 24px;
                font-weight: 800;
                background: linear-gradient(180deg, #e8c547 0%, #ef882b 100%);
                background-clip: text;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                pointer-events: none;
                user-select: none;
                animation: move-up 2s forwards;
            }

            @keyframes move-up {
                0% { opacity: 1; transform: translateY(0); }
                100% { opacity: 0; transform: translateY(-50px); }
            }
        }
        button{
            background-color: deepskyblue;
            color: black;
        }

        .newgame{
            background-color: orangered;
            color: white;
        }
        #selectionScreen {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #222;
    border-radius: 10px;
    padding: 20px;
    z-index: 1000;
    text-align: center;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    width: 80%;
    max-width: 500px;
}

.clicker-options {
    display: flex;
    flex-wrap: wrap; /* Для адаптивности */
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}

.clicker-option {
    width: 100px;
    height: 100px;
    cursor: pointer;
    border-radius: 10px;
    transition: transform 0.2s ease;
}

.clicker-option:hover {
    transform: scale(1.1);
}

#selectClickerLink {
    display: block;
    margin-top: 10px;
    color: gold;
    font-size: 16px;
    text-decoration: underline;
    cursor: pointer;
}

#selectClickerLink:hover {
    color: orange;
}

.close-button {
    margin-top: 20px;
    padding: 10px 20px;
    background-color: orangered;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.2s ease;
}

.close-button:hover {
    background-color: #a02620;
}

/* Адаптивность для маленьких экранов */
@media (max-width: 768px) {
    .clicker-option {
        width: 120px;
        height: 120px;
    }

    #selectionScreen h2 {
        font-size: 18px;
    }

    .close-button {
        font-size: 14px;
        padding: 8px 16px;
    }
}


     
.new-badge {
    position: absolute;
    top: -5px; /* Отступ от верхней части кнопки */
    right: -10px; /* Отступ от правой части кнопки */
    background-color: gold;
    color: black;
    padding: 3px 5px;
    border-radius: 3px;
    font-size: 12px;
    font-weight: bold;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.5); /* Добавляет тень для лучшего визуального эффекта */
}
@media (max-width: 768px) {
    .clicker-options {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* Две колонки */
        gap: 15px; /* Расстояние между картинками */
    }


    #selectionScreen h6 {
        font-size: 18px;
    }

    .close-button {
        font-size: 14px;
        padding: 8px 16px;
    }
    #confirmModal{
        width: 300px;
    }
}
#confirmModal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgb(0, 0, 0);
    color: white;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
    z-index: 1000;
}

        #confirmModal h6 {
            color: white;
            margin-bottom: 20px;
        }

        #confirmModal .modal-buttons {
            display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}
        

        #confirmModal .modal-buttons button {
            padding: 10px 20px;
            background-color: orangered;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s ease;
        }

        #confirmModal .modal-buttons button:hover {
            background-color: #a02620;
        }

        #confirmModal .modal-buttons .cancel {
            background-color: deepskyblue;
        }

        #confirmModal .modal-buttons .cancel:hover {
            background-color: dodgerblue;
        }


    </style>
</head>
<body>
    <div id="introScreen" class="intro-screen hidden">
        <div id="storyText" class="story-text"></div>
    </div>
    <div id="gameScreen" class="game-screen hidden">
        <div class="top-bar">
            <span id="clickCount" class="click-count">0</span> / 10000
        </div>
        <img id="batImage" src="plov.png" alt="Bat" class="main-bat">
        <div class="buttons">
            <button onclick="showStory()" class="story-button">
                <i style="color: rgb(139, 79, 1); font-size: 15px;" >New</i> Сюжет
            </button>
            
            </button>            
            <button class="newgame"  onclick="showConfirmModal()" >Новая игра</button>
            <button id="endButton" class="hidden" onclick="triggerEnding()" style="background-color: gold; color: black;">Концовка</button>
        </div>
        <div id="selectionScreen" class="hidden">
            <h2>Выберите свой кликер:</h2>
            <div class="clicker-options">
                <img src="mish-Photoroom.png" alt="Mouse" class="clicker-option" onclick="window.location.href='https://maxkranz.github.io/ru/games/mouse'">
                <img src="plov.png" alt="Plov" class="clicker-option" onclick="window.location.href='https://maxkranz.github.io/ru/games/plov'">
                <img src="u.png" alt="Unicorn" class="clicker-option" onclick="window.location.href='https://maxkranz.github.io/ru/games/unicorn'">
                <img src="k.png" alt="Poop" class="clicker-option" onclick="window.location.href='https://maxkranz.github.io/ru/games/kakashka'">
            </div>
            <button class="close-button" onclick="closeClickerSelection()">Закрыть</button>
        </div>
        <a href="#" id="selectClickerLink" onclick="showClickerSelection()" style="margin-top: 30px;">Что вы хотите тапать?</a>
        
        </div>
        
    </div>
    <div id="endScreen" class="end-screen hidden">
        <h1 id="endText">Какашка смыта!</h1>
        <img id="explodingBat" src="k.png" alt="Bat" class="main-bat hidden">
        <div class="buttons">
            <button onclick="freeMode()" style="background-color: rgb(0, 201, 0);">Свободный режим</button>
            <button  class="newgame" onclick="showConfirmModal()">Новая игра</button>
            <button id="shareButton">Поделиться результатом</button>
        </div>
    </div>
    <div id="confirmModal">
        <p>Вы уверены, что хотите начать новую игру? Весь прогресс будет сброшен.</p>
        <div class="modal-buttons">
            <button class="confirm" onclick="restartGame(),closeConfirmModal()">Да</button>
            <button class="cancel" onclick="closeConfirmModal()">Отмена</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script>
       
       let freeModeActive = false; 
       const storyTexts = [
"It was//",
 "Однажды, в далекие времена, Александр Македонский оказался в далекой Персии.", 
 "После долгих битв и завоеваний он был приглашен на пир, где ему впервые предложили удивительное блюдо — плов.",
  "Это блюдо так ему понравилось, что он приказал своим поварам научиться готовить его, чтобы всегда напоминать себе о триумфе в Персии.",
 "Но чтобы забрать его с собой, ему нужно 10000 раз тапнуть по плову!", 

];


let currentStoryIndex = 0;
let gameStarted = localStorage.getItem('gameStarted') === 'true';
let storyCompleted = localStorage.getItem('storyCompleted') === 'true';

document.addEventListener("DOMContentLoaded", () => {
    if (!gameStarted || !storyCompleted) {
        document.getElementById("introScreen").classList.remove("hidden");
        showNextStory();
    } else {
        document.getElementById("gameScreen").classList.remove("hidden");
        clickCount = parseInt(localStorage.getItem('clickCount')) || 0;
        document.getElementById("clickCount").textContent = clickCount;
    }
});

document.addEventListener("click", () => {
    if (!storyCompleted) {
        showNextStory();
    }
});

function showNextStory() {
    if (currentStoryIndex < storyTexts.length) {
        const storyTextElement = document.getElementById("storyText");
        storyTextElement.textContent = storyTexts[currentStoryIndex];
        currentStoryIndex++;
    } else {
        storyCompleted = true;
        localStorage.setItem('storyCompleted', 'true');
        startGame();
    }
}

        const batImage = document.getElementById('batImage');
        batImage.addEventListener('click', (event) => {
            incrementClicks(event); 
            animateBatTilt(event); 
        });

 
        function startGame() {
            document.getElementById("introScreen").classList.add("hidden");
            document.getElementById("gameScreen").classList.remove("hidden");
            localStorage.setItem('gameStarted', 'true');
        }

        function incrementClicks(event) {
            clickCount++; 
            document.getElementById("clickCount").textContent = clickCount;
            localStorage.setItem('clickCount', clickCount);

            showClickText(event.pageX, event.pageY); 

            if (!freeModeActive && clickCount >= 10000) {
                endGame();
            }
        }
        function showClickText(x, y) {
    const clickText = document.createElement('div');
    clickText.className = 'click-text';
    clickText.textContent = '+1';
    clickText.style.left = `${x}px`;
    clickText.style.top = `${y - 50}px`; 
    document.body.appendChild(clickText);

    setTimeout(() => {
        clickText.remove();
    }, 1000); 
}
function showConfirmModal() {
            document.getElementById("confirmModal").style.display = "block";
        }

        function closeConfirmModal() {
            document.getElementById("confirmModal").style.display = "none";
        }

        function animateBatTilt(event) {
            const $bat = document.getElementById('batImage');
            const rect = $bat.getBoundingClientRect();

            const offsetX = event.clientX - rect.left - rect.width / 2;
            const offsetY = event.clientY - rect.top - rect.height / 2;

            const DEG = 40;

            const tiltX = (offsetY / rect.height) * DEG;
            const tiltY = (offsetX / rect.width) * -DEG;

            $bat.style.setProperty('--tiltX', `${tiltX}deg`);
            $bat.style.setProperty('--tiltY', `${tiltY}deg`);

            setTimeout(() => {
                $bat.style.setProperty('--tiltX', '0deg');
                $bat.style.setProperty('--tiltY', '0deg');
            }, 300);
        }

        function endGame() {
            document.getElementById("gameScreen").classList.add("hidden");
            document.getElementById("endScreen").classList.remove("hidden");
            triggerExplosion();
        }

        function triggerExplosion() {
            const batImage = document.getElementById("explodingBat");
            batImage.classList.remove("hidden");
            batImage.classList.add("exploding");
            setTimeout(() => {
                batImage.classList.add("hidden");
            }, 1000);
        }

        function freeMode() {
            freeModeActive = true;
            document.getElementById("endScreen").classList.add("hidden");
            document.getElementById("gameScreen").classList.remove("hidden");

            document.getElementById("endButton").classList.remove("hidden");
        }

        function triggerEnding() {
            endGame();
        }
        function showClickerSelection() {
    document.getElementById('selectionScreen').classList.remove('hidden');
}
function showClickerSelection() {
    document.getElementById('selectionScreen').classList.remove('hidden');
}

function closeClickerSelection() {
    document.getElementById('selectionScreen').classList.add('hidden');
}

function selectClicker(name, imagePath) {
    alert(`You selected ${name}!`);
    document.getElementById('batImage').src = imagePath; // Меняем изображение
    closeClickerSelection(); // Закрываем окно после выбора
}


function selectClicker(name, imagePath) {
    alert(`You selected ${name}!`);
    document.getElementById('batImage').src = imagePath; // Replace the main bat image with the selected one
    document.getElementById('selectionScreen').classList.add('hidden'); // Hide the selection screen
}


    



        function restartGame() {
            clickCount = 0;
            freeModeActive = false; 
            localStorage.setItem('clickCount', clickCount);
            document.getElementById("clickCount").textContent = clickCount;
            document.getElementById("endScreen").classList.add("hidden");
            document.getElementById("gameScreen").classList.remove("hidden");

           
            document.getElementById("endButton").classList.add("hidden");
        }

        function resetGame() {
            localStorage.removeItem('gameStarted');
            localStorage.removeItem('clickCount');
            localStorage.removeItem('storyCompleted');
            document.getElementById("gameScreen").classList.add("hidden");
            currentStoryIndex = 0;
            storyCompleted = false;
            showNextStory();
        }

        function showStory() {
            document.getElementById("gameScreen").classList.add("hidden");
            currentStoryIndex = 0;  
            storyCompleted = false;
            document.getElementById("introScreen").classList.remove("hidden");
            showNextStory();
        }

        document.getElementById('shareButton').addEventListener('click', () => {
            html2canvas(document.body).then(canvas => {
                const link = document.createElement('a');
                link.download = 'plov.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        });
        let clickCount = parseInt(localStorage.getItem('clickCount')) || 0;
document.getElementById("clickCount").textContent = clickCount;

 
    </script>
</body>
</html>